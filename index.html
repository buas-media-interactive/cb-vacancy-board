<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creative Business Media Lab Project Vacancy Board 2025-2026 | BUas</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #FF6600 0%, #0066CC 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .difficulty-easy {
            background-color: #CCE5FF;
            color: #0052A3;
        }
        
        .difficulty-intermediate {
            background-color: #FFE5CC;
            color: #CC5200;
        }
        
        .difficulty-advanced {
            background-color: #FFB366;
            color: #8B3A00;
        }
        
        .category-badge {
            background-color: #FFE5CC;
            color: #CC5200;
        }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #FF6600;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const VacancyBoard = () => {
            const [projectData, setProjectData] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedCategory, setSelectedCategory] = useState('All');
            const [selectedYear, setSelectedYear] = useState('All');
            const [selectedDifficulty, setSelectedDifficulty] = useState('All');
            const [selectedBlock, setSelectedBlock] = useState('All');
            const [expandedCard, setExpandedCard] = useState(null);

            // ⚠️ REPLACE THIS WITH YOUR GOOGLE SHEET ID ⚠️
            // Find it in your sheet URL: https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID_HERE/edit
            const GOOGLE_SHEET_ID = '10KPIntSvc7kbkjkTKJSTCxK50H29HHuB4kTN31UKFfI';
            const SHEET_NAME = 'Sheet1'; // Change if your sheet has a different name

            useEffect(() => {
                const fetchData = async () => {
                    try {
                        // Google Sheets CSV export URL
                        const url = `https://docs.google.com/spreadsheets/d/${GOOGLE_SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}`;
                        
                        const response = await fetch(url);
                        if (!response.ok) {
                            throw new Error('Failed to fetch data from Google Sheets. Make sure the sheet is publicly accessible.');
                        }

                        const csvText = await response.text();
                        const data = parseCSV(csvText);
                        setProjectData(data);
                        setLoading(false);
                    } catch (err) {
                        setError(err.message);
                        setLoading(false);
                    }
                };

                fetchData();
            }, []);

            // Parse CSV data
            const parseCSV = (csvText) => {
                const lines = csvText.split('\n');
                const headers = parseCSVLine(lines[0]);
                const data = [];

                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim()) {
                        const values = parseCSVLine(lines[i]);
                        const obj = {};
                        headers.forEach((header, index) => {
                            obj[header] = values[index] || '';
                        });
                        data.push(obj);
                    }
                }

                return data;
            };

            // Parse a single CSV line (handles quoted fields)
            const parseCSVLine = (line) => {
                const result = [];
                let current = '';
                let inQuotes = false;

                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    const nextChar = line[i + 1];

                    if (char === '"') {
                        if (inQuotes && nextChar === '"') {
                            current += '"';
                            i++;
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === ',' && !inQuotes) {
                        result.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }
                result.push(current.trim());
                return result;
            };

            // Get unique values for filters
            const categories = useMemo(() => {
                const cats = ['All', ...new Set(projectData.map(p => p.Category).filter(Boolean))];
                return cats.sort();
            }, [projectData]);

            const years = useMemo(() => {
                const yrs = ['All', ...new Set(projectData.map(p => p.Year).filter(Boolean))];
                return yrs.sort();
            }, [projectData]);

            const difficulties = useMemo(() => {
                return ['All', 'easy', 'intermediate', 'advanced'];
            }, []);

            const blocks = useMemo(() => {
                const blks = ['All', ...new Set(projectData.map(p => p.Block).filter(Boolean))];
                return blks.sort();
            }, [projectData]);

            // Filter projects
            const filteredProjects = useMemo(() => {
                return projectData.filter(project => {
                    const matchesSearch = 
                        (project['Project title'] || '').toLowerCase().includes(searchTerm.toLowerCase()) ||
                        (project['Short description'] || '').toLowerCase().includes(searchTerm.toLowerCase()) ||
                        (project.Client || '').toLowerCase().includes(searchTerm.toLowerCase());

                    const matchesCategory = selectedCategory === 'All' || project.Category === selectedCategory;
                    const matchesYear = selectedYear === 'All' || project.Year === selectedYear;
                    const matchesDifficulty = selectedDifficulty === 'All' || 
                        (project['Difficulty level'] || '').toLowerCase().trim() === selectedDifficulty.toLowerCase();
                    const matchesBlock = selectedBlock === 'All' || project.Block === selectedBlock;

                    return matchesSearch && matchesCategory && matchesYear && matchesDifficulty && matchesBlock;
                });
            }, [projectData, searchTerm, selectedCategory, selectedYear, selectedDifficulty, selectedBlock]);

            const resetFilters = () => {
                setSearchTerm('');
                setSelectedCategory('All');
                setSelectedYear('All');
                setSelectedDifficulty('All');
                setSelectedBlock('All');
            };

            const getDifficultyClass = (difficulty) => {
                const diff = (difficulty || '').toLowerCase().trim();
                if (diff === 'easy') return 'difficulty-easy';
                if (diff === 'intermediate') return 'difficulty-intermediate';
                if (diff === 'advanced') return 'difficulty-advanced';
                return 'difficulty-intermediate';
            };

            // Loading state
            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-gray-50">
                        <div className="text-center">
                            <div className="loading-spinner mx-auto mb-4"></div>
                            <p className="text-gray-600 text-lg">Loading vacancies...</p>
                        </div>
                    </div>
                );
            }

            // Error state
            if (error) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-gray-50 px-4">
                        <div className="max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center">
                            <div className="text-red-500 text-5xl mb-4">⚠️</div>
                            <h2 className="text-2xl font-bold text-gray-900 mb-4">Unable to Load Data</h2>
                            <p className="text-gray-600 mb-4">{error}</p>
                            <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-left text-sm">
                                <p className="font-semibold text-yellow-800 mb-2">Setup Instructions:</p>
                                <ol className="list-decimal list-inside space-y-1 text-yellow-700">
                                    <li>Open this HTML file in a text editor</li>
                                    <li>Find the line: <code className="bg-yellow-100 px-1">const GOOGLE_SHEET_ID = 'YOUR_SHEET_ID_HERE';</code></li>
                                    <li>Replace with your actual Google Sheet ID</li>
                                    <li>Make sure your sheet is set to "Anyone with the link can view"</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Header */}
                    <header className="gradient-bg text-white py-12 shadow-lg">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <h1 className="text-4xl md:text-5xl font-bold mb-4">Project Vacancy Board</h1>
                            <p className="text-xl md:text-2xl text-blue-100">Creative Business Media Lab | Academic Year 2025-2026</p>
                            <p className="text-lg text-blue-100 mt-2">Breda University of Applied Sciences</p>
                        </div>
                    </header>

                    {/* Filters Section */}
                    <div className="bg-white shadow-md border-b border-gray-200">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                            {/* Search Bar */}
                            <div className="mb-6">
                                <input
                                    type="text"
                                    placeholder="Search by project title, description, or client..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-lg"
                                />
                            </div>

                            {/* Filter Dropdowns */}
                            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
                                <div>
                                    <label className="block text-xs font-semibold text-gray-700 mb-1">Category</label>
                                    <select
                                        value={selectedCategory}
                                        onChange={(e) => setSelectedCategory(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-sm"
                                    >
                                        {categories.map(cat => (
                                            <option key={cat} value={cat}>{cat}</option>
                                        ))}
                                    </select>
                                </div>

                                <div>
                                    <label className="block text-xs font-semibold text-gray-700 mb-1">Year</label>
                                    <select
                                        value={selectedYear}
                                        onChange={(e) => setSelectedYear(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-sm"
                                    >
                                        {years.map(year => (
                                            <option key={year} value={year}>{year}</option>
                                        ))}
                                    </select>
                                </div>

                                <div>
                                    <label className="block text-xs font-semibold text-gray-700 mb-1">Difficulty</label>
                                    <select
                                        value={selectedDifficulty}
                                        onChange={(e) => setSelectedDifficulty(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-sm"
                                    >
                                        {difficulties.map(diff => (
                                            <option key={diff} value={diff}>{diff}</option>
                                        ))}
                                    </select>
                                </div>

                                <div>
                                    <label className="block text-xs font-semibold text-gray-700 mb-1">Block</label>
                                    <select
                                        value={selectedBlock}
                                        onChange={(e) => setSelectedBlock(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-sm"
                                    >
                                        {blocks.map(block => (
                                            <option key={block} value={block}>{block === 'All' ? 'All' : block}</option>
                                        ))}
                                    </select>
                                </div>

                                <div className="flex items-end">
                                    <button
                                        onClick={resetFilters}
                                        className="w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium text-sm"
                                    >
                                        Reset Filters
                                    </button>
                                </div>
                            </div>

                            {/* Results Count */}
                            <div className="mt-4 text-center">
                                <span className="text-gray-600 font-medium">
                                    Showing {filteredProjects.length} of {projectData.length} projects
                                </span>
                            </div>
                        </div>
                    </div>

                    {/* Projects Grid */}
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {filteredProjects.length === 0 ? (
                            <div className="text-center py-12">
                                <p className="text-xl text-gray-500">No projects found matching your criteria.</p>
                                <p className="text-gray-400 mt-2">Try adjusting your filters or search terms.</p>
                            </div>
                        ) : (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                {filteredProjects.map((project, index) => {
                                    const isExpanded = expandedCard === index;
                                    return (
                                        <div 
                                            key={index} 
                                            className="bg-white rounded-lg shadow-md p-6 card-hover border border-gray-200 flex flex-col"
                                        >
                                            {/* Category and Difficulty Badges */}
                                            <div className="flex items-start justify-between mb-3 flex-wrap gap-2">
                                                <span className="badge category-badge text-xs">
                                                    {project.Category}
                                                </span>
                                                {project['Difficulty level'] && (
                                                    <span className={`badge text-xs ${getDifficultyClass(project['Difficulty level'])}`}>
                                                        {project['Difficulty level'].trim()}
                                                    </span>
                                                )}
                                            </div>

                                            {/* Project Title */}
                                            <h3 className="text-xl font-bold text-gray-900 mb-2 line-clamp-2">
                                                {project['Project title']}
                                            </h3>

                                            {/* Client */}
                                            {project.Client && (
                                                <p className="text-gray-700 font-semibold mb-3">{project.Client}</p>
                                            )}

                                            {/* Short Description */}
                                            {project['Short description'] && (
                                                <p className={`text-sm text-gray-600 mb-4 ${isExpanded ? '' : 'line-clamp-3'}`}>
                                                    {project['Short description']}
                                                </p>
                                            )}

                                            {/* Show More/Less Button */}
                                            {project['Short description'] && project['Short description'].length > 150 && (
                                                <button
                                                    onClick={() => setExpandedCard(isExpanded ? null : index)}
                                                    className="text-orange-600 hover:text-orange-700 text-sm font-medium mb-3 text-left"
                                                >
                                                    {isExpanded ? '← Show less' : 'Show more →'}
                                                </button>
                                            )}

                                            {/* Details Grid */}
                                            <div className="space-y-2 text-sm text-gray-600 mb-4 mt-auto">
                                                <div className="flex">
                                                    <span className="font-semibold w-16">Year:</span>
                                                    <span>{project.Year}</span>
                                                </div>
                                                <div className="flex">
                                                    <span className="font-semibold w-16">Block:</span>
                                                    <span className="truncate" title={project.Block}>{project.Block}</span>
                                                </div>
                                                {project.Start && project.Start !== 't.b.d.' && (
                                                    <div className="flex">
                                                        <span className="font-semibold w-16">Period:</span>
                                                        <span className="truncate">
                                                            {project.Start} - {project.Finish || 't.b.d.'}
                                                        </span>
                                                    </div>
                                                )}
                                            </div>

                                            {/* Website Link */}
                                            {project.Website && project.Website !== 'n.a.' && project.Website !== '' && (
                                                <div className="border-t pt-4 mt-auto">
                                                    <a 
                                                        href={project.Website.startsWith('http') ? project.Website : `https://${project.Website}`}
                                                        target="_blank" 
                                                        rel="noopener noreferrer" 
                                                        className="text-sm text-orange-600 hover:text-orange-700 font-medium flex items-center"
                                                    >
                                                        Visit website →
                                                    </a>
                                                </div>
                                            )}
                                        </div>
                                    );
                                })}
                            </div>
                        )}
                    </div>

                    {/* Footer */}
                    <footer className="bg-gray-800 text-white py-8 mt-12">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                            <p className="text-lg font-semibold mb-2">Breda University of Applied Sciences</p>
                            <p className="text-gray-300">Creative Business Programme | Media Lab</p>
                            <p className="text-gray-400 text-sm mt-4">Academic Year 2025-2026</p>
                        </div>
                    </footer>
                </div>
            );
        };

        ReactDOM.render(<VacancyBoard />, document.getElementById('root'));
    </script>
</body>
</html>
